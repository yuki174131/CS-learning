Prototype Pattern ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œæ™‚ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€ãã‚Œã‚‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§å¿…è¦ãªã ã‘åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚
Prototype Pattern ã«ã¯ã€ã‚­ãƒ¼ï¼šè­˜åˆ¥å­ã€å€¤ï¼šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒšã‚¢ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªãŒå«ã¾ã‚Œã€å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ãã‚Œè‡ªèº«ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹ clone() ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã€‚
ã‚­ãƒ¼ã¨å€¤ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¯ã€å˜ç´”ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã‚­ãƒ¼ã¨ãªã‚‹å‹•çš„é…åˆ—ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã€ã©ã‚“ãªå€¤ã§ã‚‚ã‚­ãƒ¼ã«ã§ãã‚‹ãƒãƒƒã‚·ãƒ¥ãƒãƒƒãƒ—ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚

å…¨ã¦ã® Prototype ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ clone() ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ­£ç¢ºã«ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹æ–¹æ³•ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã™ã‚‹æ–¹æ³•ã®è©³ç´°ã¯ã‚«ãƒ—ã‚»ãƒ«åŒ–ã•ã‚Œã¦ãŠã‚Šã€ãã®å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã®ã¯ã‚¯ãƒ©ã‚¹æ¬¡ç¬¬ã«ãªã‚‹ã€‚
https://gyazo.com/377e1e61c8e7dd3d7d6a0ddfccfb7592

import java.util.Map;
import java.util.HashMap;

interface Prototype<E>{
    abstract E clone();
}

interface Stamp extends Prototype<Stamp>{
    abstract String getTitle();
    abstract String getRender();
    abstract String getColor();
    abstract Stamp clone();
}

class GenericStamp implements Stamp{
    private final static String TITLE = "Generic Stamp";
    private final static String RENDER = "â”";

    protected String title;
    protected String render;
    protected String color;

    public GenericStamp(){};

    public GenericStamp(String color){
        this.title = GenericStamp.TITLE;
        this.render = GenericStamp.RENDER;
        this.color = color;
    }

    public GenericStamp(Stamp stamp){
        this.title = GenericStamp.TITLE;
        this.render = GenericStamp.RENDER;
        this.color = stamp.getColor();
    }

    public String getTitle(){
        return this.title;
    }

    public String getRender(){
        return this.render;
    }

    public String getColor(){
        return this.color;
    }

    public Stamp clone(){
        return new GenericStamp(this);
    }

    public String toString(){
        return this.title + " - " + this.render + " (" + this.color + ")";
    }
}

class StarStamp extends GenericStamp{
    private final static String TITLE = "Star";
    private final static String RENDER = "â­";

    public StarStamp(String color){
        this.title = StarStamp.TITLE;
        this.render = StarStamp.RENDER;
        this.color = color;
    }

    public StarStamp(Stamp stamp){
        this.title = StarStamp.TITLE;
        this.render = StarStamp.RENDER;
        this.color = stamp.getColor();
    }

    public Stamp clone(){
        return new StarStamp(this.getColor());
    }
}

class HeartStamp extends GenericStamp{
    private final static String TITLE = "Heart";
    private final static String RENDER = "ğŸ’–";

    public HeartStamp(String color){
        this.title = HeartStamp.TITLE;
        this.render = HeartStamp.RENDER;
        this.color = color;
    }

    public HeartStamp(Stamp stamp){
        this.title = HeartStamp.TITLE;
        this.render = HeartStamp.RENDER;
        this.color = stamp.getColor();
    }

    public Stamp clone(){
        return new HeartStamp(this);
    }
}

class PeaceStamp extends GenericStamp{
    private final static String TITLE = "Peace";
    private final static String RENDER = "â˜®ï¸";

    public PeaceStamp() {}

    public PeaceStamp(String color){
        this.title = PeaceStamp.TITLE;
        this.render = PeaceStamp.RENDER;
        this.color = color;
    }

    public PeaceStamp(Stamp stamp){
        this.title = PeaceStamp.TITLE;
        this.render = PeaceStamp.RENDER;
        this.color = stamp.getColor();
    }

    public Stamp clone(){
        return new PeaceStamp(this);
    }
}

class TreeStamp extends GenericStamp{
    private final static String TITLE = "Tree";
    private final static String RENDER = "ğŸŒ²";

    public TreeStamp(String color){
        this.title = TreeStamp.TITLE;
        this.render = TreeStamp.RENDER;
        this.color = color;
    }

    public TreeStamp(Stamp stamp){
        this.title = TreeStamp.TITLE;
        this.render = TreeStamp.RENDER;
        this.color = stamp.getColor();
    }

    public Stamp clone(){
        return new TreeStamp(this);
    }
}

class RainbowStamp extends GenericStamp{
    private final static String TITLE = "Rainbow";
    private final static String RENDER = "ğŸŒˆ";

    public RainbowStamp(String color){
        this.title = RainbowStamp.TITLE;
        this.render = RainbowStamp.RENDER;
        this.color = color;
    }

    public RainbowStamp(Stamp stamp){
        this.title = RainbowStamp.TITLE;
        this.render = RainbowStamp.RENDER;
        this.color = stamp.getColor();
    }

    public Stamp clone(){
        return new RainbowStamp(this);
    }
}

class StampPrototypeFactory{

    // é™çš„ãƒ¡ãƒ¢ãƒªã¸ã®æ ¼ç´
    private static Map<Integer, Stamp> stampRegistry;

    private final static String DEFAULT_COLOR = "#e74c3c";

    // é™çš„ãƒ–ãƒ­ãƒƒã‚¯ã¯ã€ã‚¯ãƒ©ã‚¹ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ã“ã‚Œã¯ã€å•é¡ŒãŒæœ€åˆã«å®Ÿè¡Œã•ã‚ŒãŸã¨ãã«é™çš„ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã™ã‚‹ã®ã«ä¾¿åˆ©ã§ã™ã€‚
    static {

        // ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®æœ€åˆã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚ã‚­ãƒ¼ã¯å¿…ãšã—ã‚‚æ•´æ•°ã§ã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
        StampPrototypeFactory.stampRegistry = new HashMap<Integer, Stamp>();

        // starã€heartã€peaceã‚¹ã‚¿ãƒ³ãƒ—ã‚’æŒã¡ã¾ã™ã€‚
        StampPrototypeFactory.stampRegistry.put(0, new GenericStamp(StampPrototypeFactory.DEFAULT_COLOR));
        StampPrototypeFactory.stampRegistry.put(1, new StarStamp(StampPrototypeFactory.DEFAULT_COLOR));
        StampPrototypeFactory.stampRegistry.put(2, new HeartStamp(StampPrototypeFactory.DEFAULT_COLOR));
        StampPrototypeFactory.stampRegistry.put(3, new PeaceStamp(StampPrototypeFactory.DEFAULT_COLOR));
    }

    // ã‚ˆã‚Šå¤šãã®é …ç›®ã‚’ç™»éŒ²ã¾ãŸã¯å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã«è¿½åŠ ã—ã¾ã™ã€‚
    public static void updatePrototype(Integer key, Stamp stamp){
        StampPrototypeFactory.stampRegistry.put(key, stamp);
    }

    // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚ã“ã‚Œã¯ãƒ¬ã‚¸ã‚¹ã‚¿å†…ã«ã‚ã‚‹ã‚‚ã®ã®ã‚¯ãƒ­ãƒ¼ãƒ³ï¼ˆãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆï¼‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
    public static Stamp get(Integer key){
        Stamp p = StampPrototypeFactory.stampRegistry.get(key);
        if(p != null) return p.clone();
        return null;
    }
}

class FairyWorld{
    public void photoBoothShoot(Integer[] stampSlots){
        String endl = System.lineSeparator();

        for(int i = 0; i < stampSlots.length; i++){
            System.out.println("Stamp - " + StampPrototypeFactory.get(stampSlots[i]) + " used in the photoshoot!");
        }
    }
}

class Main{
    public static void main(String[] args){
        String endl = System.lineSeparator();

        // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã®ã¯å‘¼ã³å‡ºã—å…ƒã®ä»•äº‹ã§ã™ã€‚å®Ÿéš›ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯ã™ã§ã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯å‹•çš„ã§ãƒ†ã‚¹ãƒˆå¯èƒ½ãªã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚
        System.out.println(StampPrototypeFactory.get(1));
        System.out.println(StampPrototypeFactory.get(0));
        System.out.println(StampPrototypeFactory.get(2));

        // ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå†…ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å‹•çš„ã«è¿½åŠ ã¾ãŸã¯ç½®æ›ã—ã¾ã™ã€‚
        // ã‚¹ãƒ­ãƒƒãƒˆ4ã‚’starã‚¹ã‚¿ãƒ³ãƒ—ã«å¤‰æ›´ã—ã¾ã™ã€‚
        StampPrototypeFactory.updatePrototype(4, new StarStamp("#f1c40f"));
        StampPrototypeFactory.updatePrototype(5, new TreeStamp("#2980b9"));
        StampPrototypeFactory.updatePrototype(6, new RainbowStamp("#ecf0f1"));
        StampPrototypeFactory.updatePrototype(7, new PeaceStamp("#95a5a6"));

        FairyWorld fw = new FairyWorld();
        fw.photoBoothShoot(new Integer[]{3,4,2,1,1,1,2,3,4,5,5,6,6,7,7,0,1,4});
    }
}


ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã«æ³¨ç›®ã€‚å…¨ãåŒã˜ã‚¯ãƒ©ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚Šã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒåŠ¹æœçš„ãªã‚±ãƒ¼ã‚¹ã‚‚ã‚ã‚‹ã€‚
è¨€èªã«ã‚ˆã‚‹ãŒã€ä¸¡æ–¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒåŒã˜ã‚¯ãƒ©ã‚¹ã‚’å…±æœ‰ã—ã¦ã„ã‚‹å ´åˆã€private ã®çŠ¶æ…‹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

ã—ã‹ã—ãªãŒã‚‰ã€è¤‡é›‘ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚±ãƒ¼ã‚¹ã§ã¯ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã‚’è¡Œã†ã®ã¯ç°¡å˜ã§ã¯ãªãã€ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚
ã“ã‚Œã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–‡å­—åˆ—ã‚„ãƒ“ãƒƒãƒˆã«å¤‰æ›ã—ã€å†åº¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ã‚’æ„å‘³ã™ã‚‹ã€‚

æœ€å¾Œã«ã€ã“ã®ã‚ˆã†ã«ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ä¸ãˆã‚‰ã‚ŒãŸå…¥åŠ›ã«åŸºã¥ã„ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ Factory ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ã«æ³¨æ„ã€‚
ã“ã‚Œã¯ã€ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã®ã§ã¯ãªãã€åŒã˜ãƒ¡ã‚½ãƒƒãƒ‰ãŒä¸ãˆã‚‰ã‚ŒãŸã‚­ãƒ¼ã§å‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã„ã†ç‚¹ã‚’é™¤ã„ã¦ã€Abstract Factory ã¨å…¨ãåŒã˜ã«ãªã‚‹ã€‚
ã“ã‚Œã¯ã€å®Ÿè¡Œæ™‚ã« Factory ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‹•çš„ã«è¿½åŠ ã™ã‚‹æ©Ÿèƒ½ã§ã‚‚ã‚ã‚‹ã€‚

ä»¥ä¸‹ã¯ã€Prototype Pattern ã®æ§‹é€ ã‚’ç¤ºã—ãŸ UMLã€‚
https://gyazo.com/fb87ffa64fc5028d00d4f6531345d704

ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¯ã„ãã¤ã‹ã®æ¬ ç‚¹ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã€‚Abstract Factory ã‚„ Builder ã¨åŒæ§˜ã«ã€Prototype ç”¨ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚’ä½œæˆã™ã‚‹ã®ã¯éå¸¸ã«è¤‡é›‘ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
Factory Method ã‚’ä½¿ã† Abstract Factory ã¨ã¯ç•°ãªã‚Šã€ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹æ‹¡å¼µæ€§ã¯ã»ã¨ã‚“ã©ãªãã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒä½¿ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹æ‰‹é †ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ã¯ã»ã¨ã‚“ã©ã§ããªã„ã€‚

ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œæ™‚ã«è¦ç´ ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†ã“ã¨ã¯ã€å‹•çš„ã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã€è¨€ã„æ›ãˆã‚Œã°ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯ã®æ©æµï¼ˆä¾‹ãˆã°ã€obj.getAddress() ã¨ã„ã†ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãŸæ™‚ã«ã€getAddress() ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã•ã‚Œã‚‹ç­‰ï¼‰
ã‚’å®Œå…¨ã«å—ã‘ã‚‹ã“ã¨ãŒã§ããªã„ã“ã¨ã‚’æ„å‘³ã™ã‚‹ã€‚

æœ€å¾Œã«ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹ Factory Method ã¨ã¯ç•°ãªã‚Šã€Factory ã®ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå†…ã«é…ç½®ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ã«æ³¨æ„ã€‚
ä¾‹ãˆã°ã€Factory Method ã§ã¯ã€æ—¢ã«ä½œæˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ¼ãƒ«å†…ã«å­˜åœ¨ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å†åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚